/**
 * @file: code_player.js
 * This file implements code player.
 */var CodePlayer=function(){if(typeof AceDocument!="undefined")var a=AceDocument;else var a=require("ace/document").Document;return function(a){this.record_url,this.options={schedule_record_after:3e3},a!==undefined&&a.animate_save!==undefined?this.animate_save=a.animate_save:this.animate_save=null,this.changeset_queue=[],this.record_settimeout_id=null,this.is_record_pending=!1,this.is_record_changeset=a?a.record_changeset:!0,$.extend(this.options,a),this.enqueue_changeset=function(a,b,c,d){if(!a)return!1;var e={delta:a,source:b,timestamp:c?c:(new Date).getTime()};return d!==undefined&&(e.readonlyRanges=d),this.changeset_queue.push(e),!0},this.setRecordUrl=function(a){this.record_url=a},this.isSetupDone=function(){return!!this.record_url},this.restartRecordingAfterNetworkLost=function(){this.is_record_pending&&(this.is_record_pending=!1,this.start_recording(0))},this.is_recording_code_player=!1,this.start_recording=function(a){if(g_record_request_failed){this.is_record_pending=!0;return}if(!this.record_url)return;var b=this.restartRecordingAfterNetworkLost.bind(this);this.is_recording_code_player=!0,this.stop_recording();var c=this,d=function(){return function(){var a=c.changeset_queue,d=c.record_url,e=a.length;if(e){var f=a.splice(0,e),g=0;record_changesets(f,d,g,!0,b,c.animate_save,c.is_record_changeset),c.is_recording_code_player=!1}}}(c);a===undefined&&(a=this.options.schedule_record_after),this.record_settimeout_id=setTimeout(d,a)},this.stop_recording=function(){this.is_recording()&&clearTimeout(this.record_settimeout_id),this.record_settimeout_id=null},this.is_recording=function(){return this.record_settimeout_id?!0:!1},this.finish_recording=function(){var a=this.changeset_queue,b=this.record_url,c=a.length;if(c){var d=a.splice(0,c),e=0;return record_changesets(d,b,e,!0,undefined,this.animate_save,this.is_record_changeset),!0}return call_animate_save(".editor-save-code",!0),!1}}}();